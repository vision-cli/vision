# Setup

Setting up the system for local development

## Database

Spin up the default postgres database with `make pg-local` (container uses postgres:alpine).
New grpc services will have a url configured to connect to this db on port `5432`.
The same postgres service will be provided in the generated GitHub workflow for testing.

## Run in development

Setting up a cluster with a local image registry and postgres db:

- ensure kind, grpcurl, cilium cli, and hubble cli are installed and docker is running
- create kind cluster and containers for registry and postgres with `make cluster-local`
- deploy cilium onto cluster with `make cilium-deploy`
- configure the cilium network policy with `make apply-network-policy`

Deploy a service:

- navigate to `services/<Namespace>/<ServiceName>`
- build the service image and deploy with `make deploy-local`

Make a request:

- forward the port of a service to `localhost:8080` with `make port-forward-local`
- send a request to a grpc service with `make request-local` using variables: BODY, METHOD
  _e.g._ `make request-local BODY='{"name": "Alice"}' METHOD=SayHello` (METHOD default is SayHello)
- send http requests to a gateway service (curl) via an exposed grpc service endpoint

_generated by vision_
